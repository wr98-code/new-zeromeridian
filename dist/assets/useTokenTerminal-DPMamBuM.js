import{r as s}from"./vendor-icons-BDtiwxs7.js";import{u as i}from"./vendor-query-BhSX34xp.js";const l="https://api.tokenterminal.com/v2";async function c(t){try{const n=await fetch(l+"/projects",{signal:t,headers:{Accept:"application/json"}});return n.ok?((await n.json()).data??[]).map(e=>!e.project_id||!e.name?null:{projectId:String(e.project_id),name:String(e.name??""),symbol:String(e.symbol??""),logoUrl:String(e.logo??""),categoryTags:Array.isArray(e.tags)?e.tags.map(String):[],revenueOneDayUsd:Number(e.revenue_1d??0),revenueSevenDayUsd:Number(e.revenue_7d??0),revenueThirtyDayUsd:Number(e.revenue_30d??0),revenueAnnualizedUsd:Number(e.revenue_annualized??0),feesOneDayUsd:Number(e.fees_1d??0),feesSevenDayUsd:Number(e.fees_7d??0),feesThirtyDayUsd:Number(e.fees_30d??0),priceToSalesRatio:e.ps!=null?Number(e.ps):null,priceToEarningsRatio:e.pe!=null?Number(e.pe):null,treasuryUsd:e.treasury!=null?Number(e.treasury):null,marketcapUsd:e.market_cap_circulating!=null?Number(e.market_cap_circulating):null,fdvUsd:e.market_cap_fully_diluted!=null?Number(e.market_cap_fully_diluted):null}).filter(e=>e!==null):[]}catch{return[]}}function p(){const t=i({queryKey:["token-terminal-protocols"],queryFn:async({signal:r})=>c(r),staleTime:3e5,refetchInterval:3e5,retry:2,retryDelay:r=>Math.min(1e3*2**r,2e4)}),n=t.data??[],a=s.useMemo(()=>[...n].filter(r=>r.revenueThirtyDayUsd>0).sort((r,o)=>o.revenueThirtyDayUsd-r.revenueThirtyDayUsd).slice(0,10),[n]),u=s.useMemo(()=>[...n].filter(r=>r.feesThirtyDayUsd>0).sort((r,o)=>o.feesThirtyDayUsd-r.feesThirtyDayUsd).slice(0,10),[n]),e=s.useMemo(()=>()=>{t.refetch()},[t]);return s.useMemo(()=>({protocols:n,topByRevenue:a,topByFees:u,isLoading:t.isLoading,isError:t.isError,refetch:e}),[n,a,u,t.isLoading,t.isError,e])}export{p as u};
