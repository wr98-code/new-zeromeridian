import{j as e}from"./vendor-radix-C8Wf2Xzy.js";import{r}from"./vendor-icons-BDtiwxs7.js";import{a as J,u as K,f as W,b as I,c as E}from"./index-BrbV88om.js";import{S as H}from"./SparklineChart-PE5wIPIp.js";import"./vendor-utils-CyvyRcDv.js";import"./vendor-query-BhSX34xp.js";import"./vendor-react-DOP_lrST.js";import"./vendor-motion-BuE0cxIe.js";let y=null,B=0;const j=new Map;let D=0;function O(){return typeof Worker>"u"?null:(y||(y=new Worker(new URL("/assets/marketWorker-CrDntJZO.js",import.meta.url),{type:"module"}),y.onmessage=t=>{const{_id:s,...a}=t.data;s&&j.has(s)&&(j.get(s)(a),j.delete(s))},y.onerror=t=>{console.error("[MarketWorker]",t.message)}),y)}function R(t,s=5e3){return new Promise((a,i)=>{const l=O();if(!l){i(new Error("Web Worker not available"));return}const n="wm_"+ ++D,c=setTimeout(()=>{j.delete(n),i(new Error("Worker timeout"))},s);j.set(n,o=>{clearTimeout(c),a(o)}),l.postMessage({...t,_id:n})})}function U(){const t=r.useRef(!0);r.useEffect(()=>(t.current=!0,B++,()=>{t.current=!1,B--,B===0&&y&&(y.terminate(),y=null,j.clear())}),[]);const s=r.useCallback(async(l,n)=>R({type:"MERGE_PRICES",assets:l,updates:n}),[]),a=r.useCallback(async(l,n,c,o)=>R({type:"SORT_FILTER",assets:l,sortKey:n,sortDir:c,query:o}),[]),i=r.useCallback(async l=>R({type:"COMPUTE_MARKET",assets:l}),[]);return{mergeAndCompute:s,sortAndFilter:a,computeMarket:i}}function Y({items:t,itemHeight:s,height:a,overscan:i=3,renderItem:l,getKey:n}){const[c,o]=r.useState(0),g=r.useRef(null),h=r.useRef(!0);r.useEffect(()=>(h.current=!0,()=>{h.current=!1}),[]);const d=r.useCallback(u=>{h.current&&o(u.currentTarget.scrollTop)},[]),{startIndex:m,endIndex:S,offsetY:b,totalHeight:x}=r.useMemo(()=>{const u=t.length*s,k=Math.max(0,Math.floor(c/s)-i),z=Math.min(t.length-1,Math.ceil((c+a)/s)+i),C=k*s;return{startIndex:k,endIndex:z,offsetY:C,totalHeight:u}},[c,t.length,s,a,i]),M=r.useMemo(()=>t.slice(m,S+1),[t,m,S]);return e.jsx("div",{ref:g,onScroll:d,style:{height:a,overflowY:"auto",overflowX:"hidden",position:"relative",willChange:"transform"},children:e.jsx("div",{style:{height:x,position:"relative"},children:e.jsx("div",{style:{transform:"translateY("+b+"px)"},children:M.map((u,k)=>e.jsx("div",{style:{height:s,overflow:"hidden"},children:l(u,m+k)},n(u,m+k)))})})})}const L=r.memo(Y);L.displayName="VirtualList";const T=40,P=48,N=()=>e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 9 9",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M4.5 1.5l-3 4h6l-3-4z",fill:"rgba(96,165,250,1)"})}),V=()=>e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 9 9",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M4.5 7.5l-3-4h6l-3 4z",fill:"rgba(96,165,250,1)"})}),G=()=>e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 9 9",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M4.5 1l-2 2.5h4L4.5 1zM4.5 8l-2-2.5h4L4.5 8z",fill:"currentColor",opacity:"0.3"})}),_=r.memo(({asset:t,index:s,isMobile:a})=>{const i=r.useRef(null),l=r.useRef(t.price),n=r.useRef(!0);r.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),r.useEffect(()=>{if(!n.current||!i.current||t.price===l.current)return;const d=t.priceDirection==="up"?"animate-flash-pos":t.priceDirection==="down"?"animate-flash-neg":"";if(!d){l.current=t.price;return}i.current.classList.remove("animate-flash-pos","animate-flash-neg"),i.current.offsetWidth,i.current.classList.add(d),l.current=t.price;const m=setTimeout(()=>{n.current&&i.current?.classList.remove(d)},300);return()=>clearTimeout(m)},[t.price,t.priceDirection]);const c=s%2===0?"rgba(255,255,255,0.012)":"transparent",o=t.change24h>=0?"rgba(52,211,153,1)":"rgba(251,113,133,1)",g=a?P:T;if(a)return e.jsxs("div",{ref:i,style:{height:g,background:c,borderBottom:"1px solid rgba(96,165,250,0.05)",display:"grid",gridTemplateColumns:"28px 1fr 90px 64px",alignItems:"center",padding:"0 12px",gap:"8px",willChange:"transform"},onMouseEnter:d=>{d.currentTarget.style.background="rgba(96,165,250,0.04)"},onMouseLeave:d=>{d.currentTarget.style.background=c},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"10px",textAlign:"right",color:"var(--zm-text-faint)"},children:t.rank}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",minWidth:0},children:[t.image?e.jsx("img",{src:t.image,alt:"",style:{width:"18px",height:"18px",borderRadius:"50%",flexShrink:0}}):e.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",flexShrink:0,background:"rgba(96,165,250,0.2)"}}),e.jsx("span",{style:{fontFamily:"'IBM Plex Mono', monospace",fontSize:"11px",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--zm-text-primary)"},children:t.symbol.toUpperCase()})]}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",textAlign:"right",color:"var(--zm-text-primary)"},children:W(t.price)}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",textAlign:"right",color:o},children:I(t.change24h)})]});const h=(t.change7d??0)>=0?"rgba(52,211,153,1)":"rgba(251,113,133,1)";return e.jsxs("div",{ref:i,style:{height:g,background:c,borderBottom:"1px solid rgba(96,165,250,0.05)",display:"flex",alignItems:"center",padding:"0 16px",gap:"12px",transition:"background 0.15s",willChange:"transform"},onMouseEnter:d=>{d.currentTarget.style.background="rgba(96,165,250,0.04)"},onMouseLeave:d=>{d.currentTarget.style.background=c},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",width:"28px",flexShrink:0,textAlign:"right",color:"var(--zm-text-faint)"},children:t.rank}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",width:"150px",flexShrink:0},children:[t.image?e.jsx("img",{src:t.image,alt:"",style:{width:"20px",height:"20px",borderRadius:"50%",flexShrink:0}}):e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",flexShrink:0,background:"rgba(96,165,250,0.2)"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[e.jsx("span",{style:{fontFamily:"'IBM Plex Mono', monospace",fontSize:"11px",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--zm-text-primary)"},children:t.symbol.toUpperCase()}),e.jsx("span",{style:{fontFamily:"'IBM Plex Mono', monospace",fontSize:"9px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--zm-text-faint)"},children:t.name})]})]}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",width:"100px",flexShrink:0,textAlign:"right",color:"var(--zm-text-primary)"},children:W(t.price)}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",width:"72px",flexShrink:0,textAlign:"right",color:o},children:I(t.change24h)}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",width:"72px",flexShrink:0,textAlign:"right",color:h},children:I(t.change7d??0)}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",width:"100px",flexShrink:0,textAlign:"right",color:"var(--zm-text-secondary)"},children:E(t.marketCap)}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:"11px",width:"100px",flexShrink:0,textAlign:"right",color:"var(--zm-text-secondary)"},children:E(t.volume24h)}),e.jsx("div",{style:{marginLeft:"auto",flexShrink:0},children:t.sparkline&&t.sparkline.length>1&&e.jsx(H,{data:t.sparkline,width:80,height:28,color:"auto"})})]})});_.displayName="AssetRow";const f=r.memo(({label:t,sortKey:s,current:a,dir:i,onSort:l,width:n="auto",align:c="right"})=>{const o=a===s,g=o?"rgba(96,165,250,1)":"var(--zm-text-faint)";return e.jsxs("button",{type:"button",style:{fontFamily:"'IBM Plex Mono', monospace",fontSize:"10px",textAlign:c,display:"flex",alignItems:"center",justifyContent:c==="right"?"flex-end":"flex-start",gap:"4px",color:g,background:"transparent",border:"none",cursor:"pointer",padding:0,width:n,flexShrink:0,letterSpacing:"0.06em",minHeight:36},onClick:()=>l(s),"aria-label":"Sort by "+t+(o?i==="asc"?", ascending":", descending":""),"aria-sort":o?i==="asc"?"ascending":"descending":"none",children:[t,o?i==="asc"?e.jsx(N,{}):e.jsx(V,{}):e.jsx(G,{})]})});f.displayName="HeaderCell";const q=r.memo(()=>{const{assets:t}=J(),s=U(),{isMobile:a}=K(),[i,l]=r.useState(""),[n,c]=r.useState("rank"),[o,g]=r.useState("asc"),[h,d]=r.useState(t),[m,S]=r.useState(!1),b=r.useRef(!0);r.useEffect(()=>(b.current=!0,()=>{b.current=!1}),[]),r.useEffect(()=>{t.length!==0&&(S(!0),s.sortAndFilter(t,n,o,i).then(p=>{b.current&&d(p.assets)}).catch(()=>{if(!b.current)return;const p=i.toLowerCase(),v=t.filter(w=>!p||w.name.toLowerCase().includes(p)||w.symbol.toLowerCase().includes(p));v.sort((w,A)=>{const F=o==="asc"?1:-1;return n==="name"?F*w.name.localeCompare(A.name):F*((w[n]??0)-(A[n]??0))}),d(v)}).finally(()=>{b.current&&S(!1)}))},[t,n,o,i,s]);const x=r.useCallback(p=>{c(v=>(g(v===p?w=>w==="asc"?"desc":"asc":"desc"),p))},[]),M=r.useCallback(p=>{l(p.target.value)},[]),u=a?P:T,k=r.useCallback((p,v)=>e.jsx(_,{asset:p,index:v,isMobile:a}),[a]),z=r.useCallback(p=>p.id,[]),C=r.useMemo(()=>Math.min(window.innerHeight-240,h.length*u),[h.length,u]);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},role:"main","aria-label":"Live Markets",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"16px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("h1",{style:{fontSize:a?"16px":"20px",fontWeight:700,fontFamily:"'IBM Plex Mono', monospace",color:"var(--zm-text-primary)",letterSpacing:"0.04em",margin:0},children:"Live Markets"}),e.jsxs("span",{style:{fontSize:"11px",fontFamily:"'JetBrains Mono', monospace",padding:"2px 8px",borderRadius:"4px",background:"rgba(52,211,153,0.1)",color:"rgba(52,211,153,1)"},children:[h.length," assets"]}),m&&e.jsx("span",{style:{fontSize:"11px",fontFamily:"'JetBrains Mono', monospace",color:"var(--zm-text-faint)"},children:"sorting..."})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 12px",borderRadius:"8px",background:"var(--zm-glass-bg)",border:"1px solid var(--zm-glass-border)",minWidth:a?"100%":"200px",minHeight:a?48:"auto"},children:[e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:[e.jsx("circle",{cx:"5",cy:"5",r:"3.5",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),e.jsx("line",{x1:"8",y1:"8",x2:"11",y2:"11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",opacity:"0.5"})]}),e.jsx("input",{type:"search",placeholder:"Search assets...",value:i,onChange:M,"aria-label":"Search assets",style:{background:"transparent",outline:"none",border:"none",fontFamily:"'IBM Plex Mono', monospace",fontSize:"12px",flex:1,color:"var(--zm-text-primary)",WebkitAppearance:"none"}})]})]}),e.jsxs("div",{style:{background:"var(--zm-glass-bg)",border:"1px solid var(--zm-glass-border)",borderRadius:"12px",overflow:"hidden"},children:[a?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"28px 1fr 90px 64px",alignItems:"center",padding:"0 12px",gap:"8px",position:"sticky",top:0,zIndex:10,height:"36px",background:"var(--zm-topbar-bg)",borderBottom:"1px solid var(--zm-glass-border)",backdropFilter:"blur(12px)"},children:[e.jsx("span",{style:{fontFamily:"'IBM Plex Mono', monospace",fontSize:"9px",color:"var(--zm-text-faint)",letterSpacing:"0.06em",textAlign:"right"},children:"#"}),e.jsx(f,{label:"Asset",sortKey:"name",current:n,dir:o,onSort:x,width:"100%",align:"left"}),e.jsx(f,{label:"Price",sortKey:"price",current:n,dir:o,onSort:x,width:90}),e.jsx(f,{label:"24h",sortKey:"change24h",current:n,dir:o,onSort:x,width:64})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0 16px",gap:"12px",position:"sticky",top:0,zIndex:10,height:"36px",background:"var(--zm-topbar-bg)",borderBottom:"1px solid var(--zm-glass-border)",backdropFilter:"blur(12px)"},children:[e.jsx("span",{style:{width:"28px",flexShrink:0}}),e.jsx("span",{style:{width:"150px",flexShrink:0,textAlign:"left"},children:e.jsx(f,{label:"Asset",sortKey:"name",current:n,dir:o,onSort:x,width:150,align:"left"})}),e.jsx(f,{label:"Price",sortKey:"price",current:n,dir:o,onSort:x,width:100}),e.jsx(f,{label:"24h",sortKey:"change24h",current:n,dir:o,onSort:x,width:72}),e.jsx(f,{label:"7d",sortKey:"change7d",current:n,dir:o,onSort:x,width:72}),e.jsx(f,{label:"Mkt Cap",sortKey:"marketCap",current:n,dir:o,onSort:x,width:100}),e.jsx(f,{label:"Volume",sortKey:"volume24h",current:n,dir:o,onSort:x,width:100}),e.jsx("span",{style:{marginLeft:"auto",fontFamily:"'IBM Plex Mono', monospace",fontSize:"10px",color:"var(--zm-text-faint)",letterSpacing:"0.06em"},children:"7d Chart"})]}),e.jsx(L,{items:h,itemHeight:u,height:C||400,overscan:5,renderItem:k,getKey:z})]})]})});q.displayName="Markets";export{q as default};
