import{j as o}from"./vendor-radix-C8Wf2Xzy.js";import{r as f}from"./vendor-icons-BDtiwxs7.js";import{G as I}from"./GlassCard-FdfA-xA0.js";import{u as B}from"./useLiquidations-D-_T2pU4.js";import{e as w}from"./index-BrbV88om.js";import{m as C}from"./vendor-motion-BuE0cxIe.js";import"./vendor-utils-CyvyRcDv.js";import"./vendor-query-BhSX34xp.js";import"./vendor-react-DOP_lrST.js";const R=60,F=12e3,x=Object.freeze({long:"rgba(251,113,133,1)",longGlow:"rgba(251,113,133,0.6)",short:"rgba(52,211,153,1)",shortGlow:"rgba(52,211,153,0.6)",whale:"rgba(251,191,36,1)",whaleGlow:"rgba(251,191,36,0.7)",text:"rgba(226,232,240,0.9)",faint:"rgba(148,163,184,0.4)",grid:"rgba(96,165,250,0.04)"});function A(e){return e>=1e7?38:e>=1e6?28:e>=5e5?22:e>=1e5?16:e>=5e4?12:e>=1e4?9:6}function T(e){return e>=1e6?"$"+(e/1e6).toFixed(1)+"M":e>=1e3?"$"+(e/1e3).toFixed(0)+"K":"$"+e.toFixed(0)}function E(e,u,a){const c=e.isWhale,i=e.side==="SELL",t=c?x.whale:i?x.long:x.short,h=c?x.whaleGlow:i?x.longGlow:x.shortGlow,g=A(e.usdValue),s=g+4,l=e.id.split("").reduce((d,y)=>d+y.charCodeAt(0),0),S=w(l)/511,v=w(l+1)/511,r=w(l+2)/511,p=w(l+3)/511;return{id:e.id,x:s+S*(u-s*2),y:s+v*(a*.7),vx:(r-.5)*.4,vy:(p-.5)*.4,r:g,color:t,glowColor:h,label:e.symbol.replace("USDT",""),usdValue:e.usdValue,alpha:1,age:0,maxAge:c?F*1.5:F,isWhale:c}}function G(e,u,a,c,i){e.clearRect(0,0,a,c),e.strokeStyle=x.grid,e.lineWidth=1/i;for(let t=0;t<a;t+=40)e.beginPath(),e.moveTo(t,0),e.lineTo(t,c),e.stroke();for(let t=0;t<c;t+=40)e.beginPath(),e.moveTo(0,t),e.lineTo(a,t),e.stroke();for(const t of u){const h=t.alpha;if(h<=0)continue;if(e.save(),e.globalAlpha=h,t.r>10){const s=t.isWhale?t.r*2.5:t.r*1.8,l=e.createRadialGradient(t.x,t.y,t.r*.3,t.x,t.y,s);l.addColorStop(0,t.glowColor.replace("0.","0.15".slice(0,-1))),l.addColorStop(1,"rgba(0,0,0,0)"),e.fillStyle=l,e.beginPath(),e.arc(t.x,t.y,s,0,Math.PI*2),e.fill()}const g=e.createRadialGradient(t.x-t.r*.3,t.y-t.r*.3,t.r*.1,t.x,t.y,t.r);if(g.addColorStop(0,t.color.replace("1)","0.6)")),g.addColorStop(1,t.color.replace("1)","0.2)")),e.fillStyle=g,e.beginPath(),e.arc(t.x,t.y,t.r,0,Math.PI*2),e.fill(),e.strokeStyle=t.color,e.lineWidth=t.isWhale?2/i:1/i,e.stroke(),t.isWhale){const s=1+Math.sin(Date.now()/400)*.15;e.strokeStyle=t.color.replace("1)","0.4)"),e.lineWidth=1/i,e.beginPath(),e.arc(t.x,t.y,t.r*s*1.4,0,Math.PI*2),e.stroke()}if(t.r>=9){e.fillStyle=x.text,e.textAlign="center",e.textBaseline="middle";const s=Math.min(9,t.r*.65);e.font="bold "+s/i*i+"px JetBrains Mono, monospace",e.fillText(t.label,t.x,t.r>=14?t.y-3:t.y),t.r>=14&&(e.fillStyle=t.color,e.font=s*.75/i*i+"px JetBrains Mono, monospace",e.fillText(T(t.usdValue),t.x,t.y+5))}e.restore()}}const z=f.memo(()=>{const{events:e,stats:u,wsStatus:a}=B(),c=f.useRef(null),i=f.useRef(null),t=f.useRef([]),h=f.useRef(0),g=f.useRef(0),s=f.useRef(Date.now());f.useEffect(()=>{const r=i.current;if(!r||e.length===0)return;const p=e.length-g.current;if(p<=0&&g.current>0)return;g.current=e.length;const d=r.clientWidth,y=r.clientHeight,m=e.slice(0,Math.min(p>0?p:5,10));for(const b of m)t.current.find(j=>j.id===b.id)||t.current.push(E(b,d,y));t.current.length>R&&(t.current=t.current.slice(-R))},[e]);const l=f.useCallback(()=>{const r=c.current,p=i.current;if(!r||!p){h.current=requestAnimationFrame(l);return}const d=window.devicePixelRatio||1,y=p.clientWidth,m=p.clientHeight;(r.width!==y*d||r.height!==m*d)&&(r.width=y*d,r.height=m*d,r.style.width=y+"px",r.style.height=m+"px");const b=r.getContext("2d");if(!b){h.current=requestAnimationFrame(l);return}const j=Date.now(),L=j-s.current;s.current=j,t.current=t.current.filter(n=>n.alpha>.01);for(const n of t.current){n.age+=L,n.x+=n.vx,n.y+=n.vy,n.vx*=.998,n.vy*=.998,n.x-n.r<0&&(n.x=n.r,n.vx=Math.abs(n.vx)),n.x+n.r>y&&(n.x=y-n.r,n.vx=-Math.abs(n.vx)),n.y-n.r<0&&(n.y=n.r,n.vy=Math.abs(n.vy)),n.y+n.r>m&&(n.y=m-n.r,n.vy=-Math.abs(n.vy));const M=n.age/n.maxAge;n.alpha=M>.7?1-(M-.7)/.3:1}b.save(),b.scale(d,d),G(b,t.current,y,m,d),b.restore(),h.current=requestAnimationFrame(l)},[]);f.useEffect(()=>(h.current=requestAnimationFrame(l),()=>cancelAnimationFrame(h.current)),[l]);const S=f.useMemo(()=>a==="connected"?"rgba(52,211,153,0.8)":a==="reconnecting"?"rgba(251,191,36,0.8)":"rgba(251,113,133,0.8)",[a]),v=r=>r>=1e6?"$"+(r/1e6).toFixed(1)+"M":r>=1e3?"$"+(r/1e3).toFixed(0)+"K":"$"+r.toFixed(0);return o.jsxs(I,{style:{height:300,display:"flex",flexDirection:"column",padding:0,overflow:"hidden"},accentColor:"rgba(251,113,133,1)",children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px 6px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"rgba(226,232,240,0.7)",fontWeight:600,letterSpacing:"0.05em"},children:"LIQUIDATIONS"}),o.jsx("span",{style:{fontSize:8,color:S},children:"●"})]}),o.jsxs("div",{style:{display:"flex",gap:12},children:[o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:8,color:"rgba(148,163,184,0.3)"},children:"LONGS LIQ"}),o.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:10,color:"rgba(251,113,133,0.9)"},children:v(u.totalLongLiqUsd)})]}),o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:8,color:"rgba(148,163,184,0.3)"},children:"SHORTS LIQ"}),o.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:10,color:"rgba(52,211,153,0.9)"},children:v(u.totalShortLiqUsd)})]}),o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:8,color:"rgba(148,163,184,0.3)"},children:"PER MIN"}),o.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:10,color:"rgba(251,191,36,0.9)"},children:u.eventsPerMinute})]})]})]}),o.jsxs("div",{ref:i,style:{flex:1,position:"relative",minHeight:0},children:[e.length===0&&o.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:6},children:[o.jsx(C.div,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},style:{width:8,height:8,borderRadius:"50%",background:S}}),o.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:10,color:"rgba(148,163,184,0.3)"},children:a==="connected"?"WAITING FOR LIQUIDATIONS...":a.toUpperCase()+"..."})]}),o.jsx("canvas",{ref:c,style:{width:"100%",height:"100%",display:"block"}})]}),o.jsxs("div",{style:{padding:"4px 12px 8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[o.jsxs("div",{style:{display:"flex",gap:10,fontFamily:"'JetBrains Mono', monospace",fontSize:8},children:[o.jsx("span",{style:{color:"rgba(251,113,133,0.7)"},children:"● LONG LIQ"}),o.jsx("span",{style:{color:"rgba(52,211,153,0.7)"},children:"● SHORT LIQ"}),o.jsx("span",{style:{color:"rgba(251,191,36,0.7)"},children:"● WHALE ≥$1M"})]}),u.largestEvent&&o.jsxs("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:8,color:"rgba(148,163,184,0.35)"},children:["LARGEST: ",u.largestEvent.symbol.replace("USDT","")," ",v(u.largestEvent.usdValue)]})]})]})});z.displayName="LiquidationTile";export{z as default};
