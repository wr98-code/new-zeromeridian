import{j as e}from"./vendor-radix-C8Wf2Xzy.js";import{r as o}from"./vendor-icons-BDtiwxs7.js";import{G as A}from"./GlassCard-FdfA-xA0.js";import{u as B}from"./useTokenTerminal-DPMamBuM.js";import{u as W,c as p}from"./index-BrbV88om.js";import{m as H}from"./vendor-motion-BuE0cxIe.js";import"./vendor-query-BhSX34xp.js";import"./vendor-utils-CyvyRcDv.js";import"./vendor-react-DOP_lrST.js";const K=Object.freeze([{key:"revenue",label:"Revenue"},{key:"fees",label:"Fees"},{key:"ratios",label:"Ratios"},{key:"treasury",label:"Treasury"}]),_=Object.freeze([{key:"1d",label:"24H"},{key:"7d",label:"7D"},{key:"30d",label:"30D"},{key:"annual",label:"Annual"}]),M=Object.freeze({dex:"rgba(52,211,153,0.8)",lending:"rgba(99,179,237,0.8)",l1:"rgba(251,191,36,0.8)",l2:"rgba(167,139,250,0.8)",nft:"rgba(249,115,22,0.8)",stablecoin:"rgba(226,232,240,0.6)",defi:"rgba(52,211,153,0.6)",exchange:"rgba(251,191,36,0.6)",default:"rgba(148,163,184,0.5)"});function G(n){for(const u of n){const t=u.toLowerCase();if(t in M)return M[t]}return M.default}const R=o.memo(({values:n,color:u,width:t=64,height:s=22})=>{const y=o.useRef(null);return o.useEffect(()=>{const i=y.current;if(!i)return;const l=i.getContext("2d");if(!l)return;const x=window.devicePixelRatio||1;i.width=t*x,i.height=s*x,i.style.width=t+"px",i.style.height=s+"px",l.scale(x,x);const c=Math.max(...n,1),g=(t-(n.length-1)*2)/n.length;l.clearRect(0,0,t,s),n.forEach((z,h)=>{const S=Math.max(2,z/c*(s-2)),m=h*(g+2),j=s-S;l.fillStyle=u,l.globalAlpha=.7+.3*(h/n.length),l.beginPath(),l.roundRect(m,j,g,S,1),l.fill()}),l.globalAlpha=1},[n,u,t,s]),e.jsx("canvas",{ref:y,style:{display:"block",willChange:"transform"},"aria-hidden":"true"})});R.displayName="MiniBar";const U=o.memo(({protocol:n,rank:u,tab:t,period:s})=>{const y=o.useMemo(()=>G(n.categoryTags),[n.categoryTags]),i=o.useMemo(()=>[n.revenueOneDayUsd,n.revenueSevenDayUsd/7,n.revenueThirtyDayUsd/30,n.revenueAnnualizedUsd/365],[n]),l=o.useMemo(()=>[n.feesOneDayUsd,n.feesSevenDayUsd/7,n.feesThirtyDayUsd/30],[n]);o.useMemo(()=>t==="revenue"?s==="1d"?n.revenueOneDayUsd:s==="7d"?n.revenueSevenDayUsd:s==="annual"?n.revenueAnnualizedUsd:n.revenueThirtyDayUsd:t==="fees"?s==="1d"?n.feesOneDayUsd:s==="7d"?n.feesSevenDayUsd:n.feesThirtyDayUsd:0,[t,s,n]);const x=o.useMemo(()=>({display:"grid",gridTemplateColumns:"28px 160px 1fr 80px 80px 80px 70px",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"6px",background:"var(--zm-surface-1)",border:"1px solid var(--zm-divider)",willChange:"transform"}),[]),c=o.useCallback(g=>g==null?"—":p(g),[]);return e.jsxs("div",{style:x,role:"row","aria-label":n.name+" fundamentals row",children:[e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-faint)",textAlign:"center"},children:u}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px",overflow:"hidden"},children:[e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"11px",fontWeight:600,color:"var(--zm-text-primary)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.name}),n.categoryTags.length>0&&e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"8px",color:y,letterSpacing:"0.06em",textTransform:"uppercase"},children:n.categoryTags[0]})]}),e.jsxs("div",{children:[t==="revenue"&&e.jsx(R,{values:i,color:y}),t==="fees"&&e.jsx(R,{values:l,color:y}),(t==="ratios"||t==="treasury")&&e.jsx("div",{style:{height:22}})]}),t==="revenue"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"rgba(52,211,153,0.9)",textAlign:"right"},children:p(n.revenueOneDayUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-secondary)",textAlign:"right"},children:p(n.revenueSevenDayUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-secondary)",textAlign:"right"},children:p(n.revenueThirtyDayUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"rgba(99,179,237,0.8)",textAlign:"right"},children:p(n.revenueAnnualizedUsd)})]}),t==="fees"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-warning)",textAlign:"right"},children:p(n.feesOneDayUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-secondary)",textAlign:"right"},children:p(n.feesSevenDayUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-secondary)",textAlign:"right"},children:p(n.feesThirtyDayUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-faint)",textAlign:"right"},children:"—"})]}),t==="ratios"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:n.priceToSalesRatio!=null&&n.priceToSalesRatio<10?"rgba(52,211,153,0.9)":"var(--zm-text-secondary)",textAlign:"right"},children:c(n.priceToSalesRatio)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:n.priceToEarningsRatio!=null&&n.priceToEarningsRatio<30?"rgba(52,211,153,0.9)":"var(--zm-text-secondary)",textAlign:"right"},children:c(n.priceToEarningsRatio)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-secondary)",textAlign:"right"},children:c(n.marketcapUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-faint)",textAlign:"right"},children:c(n.fdvUsd)})]}),t==="treasury"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-violet)",textAlign:"right"},children:c(n.treasuryUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-secondary)",textAlign:"right"},children:c(n.marketcapUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-faint)",textAlign:"right"},children:c(n.fdvUsd)}),e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-faint)",textAlign:"right"},children:"—"})]})]})});U.displayName="ProtocolRow";const Y=Object.freeze({revenue:["#","PROTOCOL","TREND","1D","7D","30D","ANNUAL"],fees:["#","PROTOCOL","TREND","1D","7D","30D","—"],ratios:["#","PROTOCOL","—","P/S","P/E","MCAP","FDV"],treasury:["#","PROTOCOL","—","TREASURY","MCAP","FDV","—"]}),q=o.memo(()=>{const{isMobile:n,isTablet:u}=W(),t=o.useRef(!0),[s,y]=o.useState("revenue"),[i,l]=o.useState("30d"),[x,c]=o.useState(""),[g,z]=o.useState("rev30d"),[h,S]=o.useState("desc");o.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]);const{protocols:m,isLoading:j,isError:C,refetch:E}=B(),O=o.useCallback(a=>{t.current&&y(a)},[]),w=o.useCallback(a=>{t.current&&l(a)},[]),P=o.useCallback(a=>{t.current&&c(a.target.value)},[]),N=o.useCallback(a=>{t.current&&z(r=>(S(r===a?f=>f==="desc"?"asc":"desc":"desc"),a))},[]),L=o.useCallback(()=>{t.current&&E()},[E]),D=o.useMemo(()=>{const a=x.toLowerCase();return m.filter(r=>!a||r.name.toLowerCase().includes(a)||r.symbol.toLowerCase().includes(a))},[m,x]),F=o.useMemo(()=>{const a=r=>{switch(g){case"rev1d":return r.revenueOneDayUsd;case"rev7d":return r.revenueSevenDayUsd;case"rev30d":return r.revenueThirtyDayUsd;case"revAnnual":return r.revenueAnnualizedUsd;case"fees1d":return r.feesOneDayUsd;case"fees30d":return r.feesThirtyDayUsd;case"ps":return r.priceToSalesRatio??1/0;case"pe":return r.priceToEarningsRatio??1/0;case"mcap":return r.marketcapUsd??0;case"fdv":return r.fdvUsd??0;case"treasury":return r.treasuryUsd??0;default:return 0}};return[...D].sort((r,f)=>h==="desc"?a(f)-a(r):a(r)-a(f))},[D,g,h]),b=o.useMemo(()=>{const a=m.reduce((d,v)=>d+v.revenueThirtyDayUsd,0),r=m.reduce((d,v)=>d+v.feesThirtyDayUsd,0),f=m.reduce((d,v)=>d+(v.marketcapUsd??0),0),T=m.filter(d=>d.priceToEarningsRatio!=null&&d.priceToEarningsRatio>0&&d.priceToEarningsRatio<1e3),V=T.length>0?[...T].sort((d,v)=>(d.priceToEarningsRatio??0)-(v.priceToEarningsRatio??0))[Math.floor(T.length/2)].priceToEarningsRatio??0:0;return{total30dRevenue:a,total30dFees:r,totalMcap:f,medianPE:V}},[m]),k=o.useCallback(a=>({fontFamily:"'Space Mono', monospace",fontSize:"10px",letterSpacing:"0.08em",padding:"5px 14px",borderRadius:"5px",background:a?"var(--zm-positive-bg)":"var(--zm-surface-1)",border:"1px solid "+(a?"var(--zm-positive-border)":"var(--zm-divider)"),color:a?"var(--zm-positive)":"var(--zm-text-secondary)",cursor:"pointer",willChange:"transform"}),[]),I=o.useMemo(()=>({display:"grid",gridTemplateColumns:"28px 160px 1fr 80px 80px 80px 70px",gap:"8px",padding:"4px 12px 8px"}),[]);return j?e.jsx("div",{style:{padding:"24px",display:"flex",flexDirection:"column",gap:"12px"},children:[...Array(8)].map((a,r)=>e.jsx("div",{style:{height:"44px",background:"var(--zm-surface-1)",borderRadius:"6px",border:"1px solid var(--zm-divider)"}},r))}):e.jsxs(H.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.35,ease:[.22,1,.36,1]},style:{padding:"20px 24px",display:"flex",flexDirection:"column",gap:"16px",willChange:"transform"},role:"main","aria-label":"Fundamentals page",children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexWrap:"wrap",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontFamily:"'Space Mono', monospace",fontSize:"13px",fontWeight:700,letterSpacing:"0.12em",color:"var(--zm-text-primary)",margin:0},children:"FUNDAMENTALS"}),e.jsx("p",{style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",color:"var(--zm-text-faint)",letterSpacing:"0.06em",margin:"2px 0 0"},children:"TOKEN TERMINAL — PROTOCOL REVENUE & FEES"})]}),e.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[e.jsx("span",{style:{fontFamily:"'Space Mono', monospace",fontSize:"9px",color:"var(--zm-text-faint)"},children:m.length+" protocols"}),e.jsx("button",{type:"button",onClick:L,"aria-label":"Refresh fundamentals data",style:k(!1),children:"↻ REFRESH"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:n?"1fr 1fr":u?"repeat(2, 1fr)":"repeat(4, 1fr)",gap:"10px"},children:[{label:"30D REVENUE",value:p(b.total30dRevenue),color:"var(--zm-positive)"},{label:"30D FEES",value:p(b.total30dFees),color:"var(--zm-warning)"},{label:"TOTAL MCAP",value:p(b.totalMcap),color:"var(--zm-accent)"},{label:"MEDIAN P/E",value:b.medianPE>0?b.medianPE.toFixed(1)+"x":"—",color:"var(--zm-violet)"}].map(a=>e.jsxs(A,{style:{padding:"12px 16px"},children:[e.jsx("div",{style:{fontFamily:"'Space Mono', monospace",fontSize:"8px",letterSpacing:"0.1em",color:"var(--zm-text-faint)",marginBottom:"6px"},children:a.label}),e.jsx("div",{style:{fontFamily:"'Space Mono', monospace",fontSize:"15px",fontWeight:700,color:a.color},children:a.value})]},a.label))}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("div",{style:{display:"flex",gap:"4px"},role:"tablist","aria-label":"Data category",children:K.map(a=>e.jsx("button",{type:"button",role:"tab","aria-selected":s===a.key,onClick:()=>O(a.key),"aria-label":"View "+a.label+" data",style:k(s===a.key),children:a.label.toUpperCase()},a.key))}),(s==="revenue"||s==="fees")&&e.jsx("div",{style:{display:"flex",gap:"4px"},role:"group","aria-label":"Time period filter",children:_.filter(a=>s==="fees"?a.key!=="annual":!0).map(a=>e.jsx("button",{type:"button","aria-pressed":i===a.key,onClick:()=>w(a.key),"aria-label":"Filter by "+a.label+" period",style:{fontFamily:"'Space Mono', monospace",fontSize:"9px",padding:"3px 8px",borderRadius:"4px",background:i===a.key?"var(--zm-surface-3)":"transparent",border:"1px solid "+(i===a.key?"var(--zm-divider-strong)":"var(--zm-divider)"),color:i===a.key?"var(--zm-text-primary)":"var(--zm-text-faint)",cursor:"pointer"},children:a.label},a.key))}),e.jsx("input",{type:"text",placeholder:"Search protocol...",value:x,onChange:P,"aria-label":"Search protocols",style:{fontFamily:"'Space Mono', monospace",fontSize:"10px",padding:"5px 10px",borderRadius:"5px",background:"var(--zm-surface-1)",border:"1px solid var(--zm-divider)",color:"var(--zm-text-primary)",outline:"none",width:"180px",marginLeft:"auto"}})]}),C&&e.jsx("div",{style:{padding:"16px",background:"var(--zm-orange-bg)",borderRadius:"8px",border:"1px solid var(--zm-orange-border)",fontFamily:"'Space Mono', monospace",fontSize:"11px",color:"var(--zm-orange)"},children:"⚠ Token Terminal API unavailable — showing cached data or mock fallback."}),e.jsxs(A,{style:{padding:"12px"},children:[e.jsx("div",{style:I,role:"row",children:Y[s].map((a,r)=>e.jsx("button",{type:"button",onClick:()=>{const f={0:"name",3:s==="revenue"?"rev1d":s==="fees"?"fees1d":"ps",4:s==="revenue"?"rev7d":s==="fees"?"fees1d":"pe",5:s==="revenue"?"rev30d":s==="fees"?"fees30d":"mcap",6:s==="revenue"?"revAnnual":"fdv"};f[r]&&N(f[r])},"aria-label":"Sort by "+a,style:{fontFamily:"'Space Mono', monospace",fontSize:"8px",letterSpacing:"0.1em",color:"var(--zm-text-faint)",textAlign:r>2?"right":"left",background:"none",border:"none",cursor:"pointer",padding:0},children:a},r+a))}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"3px"},role:"table","aria-label":"Protocol fundamentals table",children:F.length===0?e.jsx("div",{style:{padding:"24px",textAlign:"center",fontFamily:"'Space Mono', monospace",fontSize:"11px",color:"var(--zm-text-faint)"},children:"No protocols found"}):F.map((a,r)=>e.jsx(U,{protocol:a,rank:r+1,tab:s,period:i},a.projectId))})]}),e.jsx("div",{style:{fontFamily:"'Space Mono', monospace",fontSize:"9px",color:"var(--zm-text-faint)",textAlign:"center",letterSpacing:"0.08em"},children:"DATA: TOKEN TERMINAL FREE TIER — UPDATES EVERY 5 MINUTES"})]})});q.displayName="Fundamentals";export{q as default};
